<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>General Competency Assessment Checklist for Assessor</title>

<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 13px;
    margin: 32px;
    color: #000;
  }

  h1 {
    text-align: center;
    font-size: 16px;
    margin-bottom: 10px;
  }

  .intro {
    margin-bottom: 8px;
    line-height: 1.4;
  }

  .scale {
    text-align: center;
    font-style: italic;
    font-size: 12px;
    margin-bottom: 12px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    border: 1px solid #000;
    padding: 6px;
    vertical-align: middle;
  }

  th {
    text-align: center;
    font-weight: bold;
  }

  .task-col { width: 45%; }

  .level {
    width: 40px;
    text-align: center;
  }

  .comments { width: 30%; }

  .section-title { font-weight: bold; }

  .task-number {
    width: 30px;
    text-align: center;
    font-weight: bold;
  }

  /* ===================== PRINT-SAFE RADIO ===================== */
  .print-radio {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  /* Hide real radio (browser print makes it faded) */
  .print-radio input[type="radio"] {
    position: absolute;
    opacity: 0;
    pointer-events: none;
    width: 0;
    height: 0;
  }

  /* Visible box that prints dark */
  .radio-box {
    width: 14px;
    height: 14px;
    border: 2px solid #000;
    box-sizing: border-box;
    display: inline-block;
  }

  /* Fill when selected */
  .print-radio input[type="radio"]:checked + .radio-box {
    background: #000;
  }

  @media print {
    .radio-box { border: 2px solid #000; }
  }

  /* ✅ typeable comments box */
  .comment-box {
    width: 100%;
    min-height: 40px;
    border: none;
    outline: none;
    resize: vertical;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 13px;
    background: transparent;
    padding: 2px 4px;
    box-sizing: border-box;
  }
</style>
</head>

<body>

<h1>General Competency Assessment Checklist for Assessor</h1>

<p class="intro">
Upon completion of the competency assessment, a Senior Officer will conduct the general competency assessment to determine if the trainee meets the required standards. The Senior Officer is responsible for assessing the trainee on the individual components and filling in the performance standards between a scale of 0 – 4. A trainee is required to attain a score of at least 3 for each component in order to pass the assessment.
</p>

<p class="scale">
1 – Need more practice, 2 – Pass, 3 – Good, 4 – Excellent
</p>

<table>
  <tr>
    <th class="task-number"></th>
    <th class="task-col">Task Outcome</th>
    <th colspan="4">Competency Level</th>
    <th class="comments">Comments</th>
  </tr>

  <tr>
    <th></th>
    <th></th>
    <th class="level">1</th>
    <th class="level">2</th>
    <th class="level">3</th>
    <th class="level">4</th>
    <th></th>
  </tr>

  <tr>
    <td class="task-number">1</td>
    <td class="section-title">Performance Assessment</td>
    <td></td><td></td><td></td><td></td>
    <td></td>
  </tr>

  <tr>
    <td></td>
    <td>Grasp of YAS knowledge and requirements</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas1" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas1" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas1" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas1" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas1_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td>Application of job knowledge</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas2" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas2" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas2" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas2" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas2_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td>Timeliness in carrying out tasks</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas3" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas3" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas3" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas3" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas3_comment"></textarea></td>
  </tr>

  <tr>
    <td class="task-number">2</td>
    <td class="section-title">Managerial Assessment</td>
    <td></td><td></td><td></td><td></td>
    <td></td>
  </tr>

  <tr>
    <td></td>
    <td>Planning</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas4" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas4" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas4" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas4" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas4_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td>Organization of work</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas5" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas5" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas5" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas5" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas5_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td>Leadership</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas6" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas6" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas6" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas6" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas6_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td>Decision-making</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas7" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas7" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas7" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas7" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas7_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td>Communication</td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas8" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas8" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas8" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas8" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas8_comment"></textarea></td>
  </tr>

  <tr>
    <td></td>
    <td><strong>Overall YAS Rating</strong></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas9" value="1"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas9" value="2"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas9" value="3"><span class="radio-box"></span></label></td>
    <td class="level"><label class="print-radio"><input class="autosave" type="radio" name="yas9" value="4"><span class="radio-box"></span></label></td>
    <td><textarea class="comment-box autosave" name="yas9_comment"></textarea></td>
  </tr>
</table>

<!-- ================= AUTOSAVE SCRIPT (FIXED FOR RADIO) ================= -->
<script>
(function () {

  const PAGE_CODE = "031";
  const SAVED_DATA = JSON.parse('{{ saved_data | tojson | safe }}');

  const fields = document.querySelectorAll(
    "input[name], textarea[name], select[name]"
  );

  // Restore
  fields.forEach(el => {
    if (!SAVED_DATA.hasOwnProperty(el.name)) return;

    if (el.type === "radio") {
      el.checked = (el.value === SAVED_DATA[el.name]);
    } else {
      el.value = SAVED_DATA[el.name];
    }
  });

  let timer = null;

  function autosaveField(fieldName, fieldValue) {
    fetch("/training/autosave", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        page_code: PAGE_CODE,
        field: fieldName,
        value: fieldValue
      })
    });
  }

  function scheduleSave(el) {
    clearTimeout(timer);
    timer = setTimeout(() => {
      if (el.type === "radio") {
        // save only when a radio becomes checked
        if (!el.checked) return;
        autosaveField(el.name, el.value);
      } else {
        autosaveField(el.name, el.value);
      }
    }, 200);
  }

  fields.forEach(el => {
    el.addEventListener("change", () => scheduleSave(el));
    el.addEventListener("input", () => scheduleSave(el));
  });

})();
</script>

</body>
</html>
