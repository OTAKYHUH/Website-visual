<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Module 4 – CMRs, Point Group & PM Allocation</title>

<style>
  /* ================= PAGE BASE ================= */
  body {
    font-family: Arial, sans-serif;
    background: #fff;
  }

  .ojt-page {
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px 10px;
    font-size: 14px;
    line-height: 1.6;
    color: #000;
  }

  /* ================= TITLE ================= */
  .module-title {
    font-weight: bold;
    font-size: 15px;
    margin-bottom: 6px;
    text-transform: uppercase;
  }

  .module-desc {
    margin-bottom: 12px;
    font-size: 13px;
  }

  /* ================= TABLE ================= */
  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }

  th, td {
    border: 1px solid #000;
    padding: 6px 8px;
    vertical-align: top;
  }

  th {
    background: #bfbfbf;
    font-weight: bold;
    text-align: left;
  }

  /* ================= COLUMN WIDTHS ================= */
  th:nth-child(1),
  td:nth-child(1) {
    width: 12%;
    text-align: center;
    font-weight: bold;
  }

  th:nth-child(2),
  td:nth-child(2) {
    width: 88%;
  }

  /* ================= INPUT ================= */
  .reason-input {
    width: 100%;
    min-height: 28px;
    border: none;
    outline: none;
    font-size: 14px;
    font-family: Arial, sans-serif;
    resize: vertical;
  }

  /* ================= FOOTER ================= */
  .page-footer {
    margin-top: 16px;
    font-size: 11px;
    color: #666;
    text-align: right;
  }
</style>
</head>

<body>

<div class="ojt-page">

  <div class="module-title">
    MODULE 4 – CMRs, POINT GROUP &amp; PM ALLOCATION
  </div>

  <div class="module-desc">
    For each Point Group listed below for P1-3 (PG1–20) while P4-6 (PG1–12),
    write its <strong>primary purpose</strong> based on your observation and training.
  </div>

  <table>
    <thead>
      <tr>
        <th>Point Group</th>
        <th>Reasons</th>
      </tr>
    </thead>

    <tbody>
      <tr>
        <td>1</td>
        <td><textarea name="pg_1_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>2</td>
        <td><textarea name="pg_2_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>3</td>
        <td><textarea name="pg_3_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>4</td>
        <td><textarea name="pg_4_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>5</td>
        <td><textarea name="pg_5_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>6</td>
        <td><textarea name="pg_6_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>11</td>
        <td><textarea name="pg_11_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>12</td>
        <td><textarea name="pg_12_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>13</td>
        <td><textarea name="pg_13_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>14</td>
        <td><textarea name="pg_14_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>15</td>
        <td><textarea name="pg_15_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>16</td>
        <td><textarea name="pg_16_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>17</td>
        <td><textarea name="pg_17_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>18</td>
        <td><textarea name="pg_18_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>19</td>
        <td><textarea name="pg_19_reason" class="reason-input"></textarea></td>
      </tr>
      <tr>
        <td>20</td>
        <td><textarea name="pg_20_reason" class="reason-input"></textarea></td>
      </tr>
    </tbody>
  </table>

  <div class="page-footer">11 | Page</div>

</div>
<script>
(function () {

  const PAGE_CODE = "YSS_011";   // change to YSS_014 for page 14
  const SAVED_DATA = {{ saved_data | default({}) | tojson | safe }};

  const fields = document.querySelectorAll(
    "input[name], textarea[name], select[name]"
  );

  // Restore
  fields.forEach(el => {
    if (!SAVED_DATA.hasOwnProperty(el.name)) return;

    if (el.type === "radio") {
      el.checked = (el.value === SAVED_DATA[el.name]);
    } else if (el.type === "checkbox") {
      el.checked = SAVED_DATA[el.name] === "true";
    } else {
      el.value = SAVED_DATA[el.name];
    }
  });

  let timer = null;

  function autosave(el) {
    fetch("/training/autosave", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        page_code: PAGE_CODE,
        field: el.name,
        value: el.type === "checkbox" ? String(el.checked) : el.value
      })
    });
  }

  fields.forEach(el => {
    const handler = () => {
      clearTimeout(timer);
      timer = setTimeout(() => autosave(el), 200);
    };
    el.addEventListener("input", handler);
    el.addEventListener("change", handler);
  });

})();
</script>

</body>
</html>
