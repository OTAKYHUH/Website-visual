<!DOCTYPE html>
<html>
<head>
    <title>Role Selection</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            padding: 2em; 
            background-color: black; 
        }
        .container {
            max-width: 1200px;
            margin: auto;
            background: black;
            padding: 0.5em;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            background: url("{{ url_for('static', filename='Background.png') }}") no-repeat center center fixed;
            background-size: 800px auto;
            position: relative;
        }
        img.logo {
            max-width: 200px;
        }
        h2 { 
            color: white;
            font-size: 3em;
            font-weight: bold; 
            font-family: 'Montserrat', sans-serif;
        }
        .button-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 24px;
            flex-wrap: nowrap;
            white-space: nowrap;
        }
        .button-group > button {
            flex: 0 0 auto;
            display: inline-flex;
        }
        button { 
            padding: 1em 2em; 
            margin: 1em; 
            font-size: 2em; 
            border: none;
            border-radius: 6px;
            background-color: #E1C233;
            color: black;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: bold;
        }
        button:hover { background-color: #0056b3; }
        .error { 
            color: red; 
            margin-top: 1em; 
            font-weight: bold; 
        }

        /* ===== Modal ===== */
        .modal {
            position: fixed; inset: 0;
            display: none;
            align-items: center; justify-content: center;
            background: rgba(0,0,0,0.6);
            z-index: 9999;
            padding: 1.5rem;
        }
        .modal.is-open { display: flex; }

        .modal__dialog {
            width: 100%;
            max-width: 350px;
            background: rgba(20,20,20,0.95);
            border-radius: 14px;
            padding: 2rem 1.5rem 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            color: #eee;
            position: relative;
        }
        .modal__dialog h3 { 
            margin: 0 0 .75rem; 
            font-family: 'Montserrat', sans-serif; 
            text-align: center;
        }
        .modal__row { text-align: left; margin-top: 1rem; }
        .modal__row label { font-weight: 600; display:block; margin-bottom: .25rem; }
        .modal__row input {
            width: 100%;
            padding: .7rem .8rem;
            border-radius: 10px;
            border: 1px solid #444;
            background: #111;
            color: #eee;
            font-size: 1rem;
            box-sizing: border-box;
        }
        .modal__actions { margin-top: 1.5rem; display: flex; gap: .5rem; justify-content: flex-end; }
        .btn {
            padding: .7rem 1rem; 
            border-radius: 10px; 
            border: 1px solid #444; 
            background: #222; 
            color: #eee; 
            cursor: pointer; 
            font-weight: 600;
            font-size: 1rem;
        }
        .btn--primary { background: #3b82f6; border-color: #3b82f6; color:#fff; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo -->
        <img src="{{ url_for('static', filename='Gold YOD Logo.png') }}" 
             alt="Logo" class="logo">

        <!-- Title -->
        <h2>YOD PERFORMANCE <br>DASHBOARD</h2>

        <!-- Error messages -->
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="error">{{ messages[0] }}</div>
          {% endif %}
        {% endwith %}

        <!-- Main Form -->
        <form method="POST" id="roleForm">
            <div class="button-group">
                <button type="submit" name="role" value="shift">Shift Team</button>
                <button type="button" data-role="non_shift" class="pw-open">Non-Shift Team</button>
                <button type="button" data-role="avp_vp" class="pw-open">AVP/VP</button>
            </div>
        </form>
    </div>

    <!-- Login Modal -->
    <div id="passwordModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="pw-title">
      <div class="modal__dialog">
        <h3 id="pw-title">Login</h3>

        <form method="POST" id="passwordForm">
          <input type="hidden" name="role" id="hiddenRole">

          <div class="modal__row">
            <label for="username-input">Username</label>
            <input id="username-input" type="text" name="username" required>
          </div>

          <div class="modal__row">
            <label for="pw-input">Password</label>
            <input id="pw-input" type="password" name="password" required autocomplete="current-password">
          </div>

          <div class="modal__actions">
            <button type="submit" class="btn btn--primary">Enter</button>
            <button type="button" class="btn" id="pwCancel">Cancel</button>
          </div>
        </form>
      </div>
    </div>

    <script>
      const modal      = document.getElementById('passwordModal');
      const pwCancel   = document.getElementById('pwCancel');
      const hiddenRole = document.getElementById('hiddenRole');
      const pwButtons  = document.querySelectorAll('.pw-open');
      const pwInput    = document.getElementById('pw-input');

      function openModal(role) {
        hiddenRole.value = role;
        modal.classList.add('is-open');
        modal.setAttribute('aria-hidden', 'false');
        setTimeout(() => document.getElementById('username-input').focus(), 0);
      }
      function closeModal() {
        modal.classList.remove('is-open');
        modal.setAttribute('aria-hidden', 'true');
        pwInput.value = '';
      }

      pwButtons.forEach(btn => {
        btn.addEventListener('click', () => openModal(btn.dataset.role));
      });

      pwCancel.addEventListener('click', closeModal);
      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('is-open')) closeModal();
      });
    </script>
</body>
</html>
